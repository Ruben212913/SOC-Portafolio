from scapy.all import *

def procesar_paquete(pkt):
    if pkt.haslayer(IP):
        ip_src = pkt[IP].src
        ip_dst = pkt[IP].dst
        protocolo = pkt[IP].proto
        print(f"[+] Paquete detectado: {ip_src} -> {ip_dst} | Protocolo: {protocolo}")

print("[*] Sniffer iniciado... Capturando 10 paquetes IP...")
sniff(filter="ip", prn=procesar_paquete, count=10)
