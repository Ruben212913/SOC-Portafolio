from scapy.all import *

objetivo = "8.8.8.8"
puerto = 53  # El puerto de DNS

print(f"[*] Escaneando puerto {puerto} en {objetivo}...")

# Creamos un paquete SYN (Flags="S")
# Queremos ver si el puerto está abierto
paquete = IP(dst=objetivo)/TCP(dport=puerto, flags="S")

respuesta = sr1(paquete, timeout=2, verbose=False)

if respuesta:
    # Si el servidor responde con SYN-ACK (Flags=0x12 o SA)
    if respuesta.haslayer(TCP) and respuesta.getlayer(TCP).flags == 0x12:
        print(f"[+] ¡PUERTO {puerto} ABIERTO!")
    else:
        print(f"[-] Puerto {puerto} cerrado.")
else:
    print(f"[-] El servidor no respondió.")