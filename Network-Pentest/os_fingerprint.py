from scapy.all import *

objetivo = "8.8.8.8"
print(f"[*] Analizando la huella de {objetivo}...")

respuesta = sr1(IP(dst=objetivo)/ICMP(), timeout=2, verbose=False)

if respuesta:
    valor_ttl = respuesta.getlayer(IP).ttl
    print(f"[+] Respuesta recibida de {objetivo}")
    print(f"[+] Valor TTL detectado: {valor_ttl}")
    
    if valor_ttl <= 64:
        print("[!] Predicción: El sistema operativo parece ser LINUX")
    elif valor_ttl <= 128:
        print("[!] Predicción: El sistema operativo parece ser WINDOWS")
    else:
        print("[?] Sistema operativo desconocido")
else:
    print("[-] No se pudo obtener respuesta.")
