from scapy.all import *

objetivo = "8.8.8.8"
# Definimos una lista de puertos comunes para auditar
puertos_a_escanear = [21, 22, 53, 80, 443]

print(f"[*] Iniciando auditoría profesional en {objetivo}...")
print("-" * 40)

for puerto in puertos_a_escanear:
    # Construcción del paquete SYN
    paquete = IP(dst=objetivo)/TCP(dport=puerto, flags="S")
    
    # Enviamos y esperamos respuesta (timeout corto para que sea rápido)
    respuesta = sr1(paquete, timeout=1, verbose=False)
    
    if respuesta:
        # Analizamos las banderas (flags) de la respuesta
        if respuesta.haslayer(TCP) and respuesta.getlayer(TCP).flags == 0x12:
            print(f"[+] Puerto {puerto: <5} | ESTADO: ABIERTO")
        else:
            print(f"[-] Puerto {puerto: <5} | ESTADO: Cerrado")
    else:
        print(f"[?] Puerto {puerto: <5} | ESTADO: Filtrado (Sin respuesta)")

print("-" * 40)
print("[*] Escaneo finalizado.")